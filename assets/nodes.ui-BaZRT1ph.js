import{d as S,r as y,a as h}from"./main-BvIeRv4f.js";import{M as x,x as p,t as v,n as I,h as b}from"./stdlib-aBcQoNak.js";var V=Object.defineProperty,M=Object.getOwnPropertyDescriptor,f=(t,i,s,r)=>{for(var n=r>1?void 0:r?M(i,s):i,o=t.length-1,e;o>=0;o--)(e=t[o])&&(n=(r?e(i,s,n):e(n))||n);return r&&n&&V(i,s,n),n};let C=class extends x{constructor(){super(...arguments),this.longEdit=null}render(){if(!this.node)return p``;const t=S.getNodeType(this.node.config.typeId);let i={domain:[0,1],range:[0,1],segments:[{id:"s1",weight:1,curve:{type:"exponential",value:0}}]};if(t&&t.inputs){const e=t.inputs.find(d=>d.name==="easing");e&&e.defaultValue&&(i=e.defaultValue)}const s=this.node.config.values?.easing??i,r={domain:s.domain||[0,1],range:s.range||[0,1],segments:(s.segments||[]).map(e=>({...e,curve:{...e.curve,type:e.curve.type}})),interactive:!0,onInteractionStart:()=>{this.longEdit=h.beginLongEdit({apply:()=>{},cancel:()=>{this.longEdit=null}})},onInteractionEnd:()=>{this.longEdit&&(this.longEdit.accept(),this.longEdit=null)},onSegmentChange:(e,d,g)=>{const l=c=>{const u=v(s),a=v(this.node.config),N=(u.segments||[]).map(m=>m.id===e&&d==="value"?{...m,curve:{...m.curve,value:g}}:m);c.setNodeConfig(this.node.id,{values:{...a.values,easing:{...u,segments:N}}})};this.longEdit?this.longEdit.applyAgain(l):l(h)},onSegmentResize:(e,d)=>{const g=l=>{const c=v(s),u=v(this.node.config),a=[...c.segments||[]];a[e]&&(a[e]={...a[e],weight:d},l.setNodeConfig(this.node.id,{values:{...u.values,easing:{...c,segments:a}}}))};this.longEdit?this.longEdit.applyAgain(g):g(h)}},n=y.inputs.get(this.node.id);let o;if(n&&(n.fields&&n.fields.value!==void 0?o=n.fields.value:n.untagged&&n.untagged.length>0&&(o=n.untagged[0])),o!==void 0){const[e,d]=r.domain||[0,1];o=(o-e)/(d-e),o=Math.max(0,Math.min(1,o))}return r.cursor=o,p`
      <graph-widget style="pointer-events: auto;" .config=${r}></graph-widget>
    `}};f([I({attribute:!1})],C.prototype,"node",2);C=f([b("curve-inspector")],C);const _=(t,i)=>p`<curve-inspector .node=${t}></curve-inspector>`,$=(t,i)=>p`<div>Curve Inspector Placeholder</div>`,P=t=>100;let E=class extends x{constructor(){super(...arguments),this.longEdit=null}render(){if(!this.node)return p``;const t=S.getNodeType(this.node.config.typeId);let i={domain:[0,1],range:[0,1],envelopeNodes:[{id:"n1",x:0,y:0},{id:"n2",x:1,y:1}],segments:[{id:"s1",weight:1,curve:{type:"linear"}}]};if(t&&t.inputs){const e=t.inputs.find(d=>d.name==="config");e&&e.defaultValue&&(i=e.defaultValue)}const s=this.node.config.curveData??this.node.config.values?.config??i,r={...s,domain:s.domain||[0,1],range:s.range||[0,1],interactive:!0,onInteractionStart:()=>{this.longEdit=h.beginLongEdit({apply:()=>{},cancel:()=>{this.longEdit=null}})},onInteractionEnd:()=>{this.longEdit&&(this.longEdit.accept(),this.longEdit=null)},onEnvelopeChange:(e,d)=>{const g=l=>{const c=v(s),u={...c,domain:c.domain||[0,1],range:c.range||[0,1],envelopeNodes:e.map(a=>({id:a.id,x:a.x,y:a.y})),segments:d.map(a=>({id:a.id,weight:a.weight,curve:{type:a.curve?.type||"linear",value:a.curve?.value,points:a.curve?.points}}))};delete u.onInteractionStart,delete u.onInteractionEnd,delete u.onEnvelopeChange,delete u.onSegmentChange,delete u.onSegmentResize,l.setNodeConfig(this.node.id,{curveData:u})};this.longEdit?this.longEdit.applyAgain(g):g(h)}},n=y.inputs.get(this.node.id);let o;if(n&&(n.fields&&n.fields.value!==void 0?o=n.fields.value:n.untagged&&n.untagged.length>0&&(o=n.untagged[0])),o!==void 0){const[e,d]=r.domain||[0,1];o=(o-e)/(d-e)}return r.cursor=o,p`
      <graph-widget style="pointer-events: auto;" .config=${r}></graph-widget>
    `}};f([I({attribute:!1})],E.prototype,"node",2);E=f([b("curve-env-inspector")],E);const D=(t,i)=>p`<curve-env-inspector .node=${t}></curve-env-inspector>`,O=t=>100;let w=class extends x{render(){if(!this.node)return p``;const t=y.uiStates.get(this.node.id),i=y.inputs.get(this.node.id),s=this.node.config.values?.mode||"start-end",r=(l,c)=>t&&typeof t[l]=="number"?t[l]:i&&i.fields&&typeof i.fields[l]=="number"?i.fields[l]:c,n=r("start",0);let o=1;if(t&&typeof t.end=="number")o=t.end;else if(s==="start-length"){const l=r("length",1);o=n+l}else o=r("end",1);o<n&&(o=n);const d={domain:[0,1],range:[0,1],interactive:!1,envelopeNodes:[{id:"n0",x:0,y:0},{id:"n1",x:n,y:0},{id:"n2",x:o,y:1},{id:"n3",x:1,y:1}],segments:[{id:"s0",weight:1,curve:{type:"linear",value:0}},{id:"s1",weight:1,curve:{type:"linear",value:0}},{id:"s2",weight:1,curve:{type:"linear",value:0}}]};let g;return i&&(i.fields&&i.fields.value!==void 0?g=i.fields.value:i.untagged&&i.untagged.length>0&&(g=i.untagged[0])),g!==void 0&&(g=Math.max(0,Math.min(1,g))),d.cursor=g,p`
      <graph-widget style="pointer-events: none; height: 50px; display: block;" .config=${d}></graph-widget>
    `}};f([I({attribute:!1})],w.prototype,"node",2);w=f([b("curve-crop-inspector")],w);const T=(t,i)=>p`<curve-crop-inspector .node=${t}></curve-crop-inspector>`,A=t=>50;export{P as CurveBodyHeight,_ as CurveBodyRenderer,A as CurveCropBodyHeight,T as CurveCropBodyRenderer,w as CurveCropInspector,O as CurveEnvBodyHeight,D as CurveEnvBodyRenderer,E as CurveEnvInspector,C as CurveInspector,$ as CurveInspectorRenderer};
//# sourceMappingURL=nodes.ui-BaZRT1ph.js.map
