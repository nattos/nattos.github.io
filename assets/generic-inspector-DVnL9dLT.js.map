{"version":3,"file":"generic-inspector-DVnL9dLT.js","sources":["../../src/views/inspector/generic-inspector.ts"],"sourcesContent":["import { html, TemplateResult } from 'lit';\nimport { GridNode } from '../../builder/state';\nimport { InspectorChangeHandler, defaultNodeRepository } from '../../structor/repository';\nimport { ROW_HEIGHT } from '../../constants';\nimport { InspectorFieldDef } from '../../structor/node-helpers';\nimport '../../views/ui-option-bar';\n\nconst getValue = (node: GridNode, path: string, fallback: any) => {\n  // 1. Try config value\n  const val = node.config?.[path];\n  if (val !== undefined) return val;\n\n  // 2. Try input definition defaultValue\n  const nodeType = defaultNodeRepository.getNodeType(node.config.typeId);\n  if (nodeType && nodeType.inputs) {\n    const input = nodeType.inputs.find(i => i.name === path);\n    if (input && input.defaultValue !== undefined) {\n      return input.defaultValue;\n    }\n  }\n\n  // 3. Fallback\n  return fallback;\n};\n\nconst renderStringField = (node: GridNode, field: Extract<InspectorFieldDef, { type: 'string' }>, onchange: InspectorChangeHandler) => html`\n  <div class=\"field\" style=\"height: ${ROW_HEIGHT}px; display: flex; align-items: center; justify-content: space-between;\">\n    <label style=\"color: var(--text-muted); font-size: 0.7em;\">${field.label}</label>\n    <input\n      type=\"text\"\n      .value=${getValue(node, field.path, field.default ?? '')}\n      placeholder=${field.placeholder || ''}\n      @input=${(e: Event) => onchange({ [field.path]: (e.target as HTMLInputElement).value })}\n      style=\"background: var(--input-bg); border: 1px solid var(--border-color); color: var(--text-color); border-radius: 4px; padding: 2px 4px; width: 120px; font-size: 0.8em;\"\n    />\n  </div>\n`;\n\nconst renderNumberField = (node: GridNode, field: Extract<InspectorFieldDef, { type: 'number' }>, onchange: InspectorChangeHandler) => html`\n  <div class=\"field\" style=\"height: ${ROW_HEIGHT}px; display: flex; align-items: center; justify-content: space-between;\">\n    <label style=\"color: var(--text-muted); font-size: 0.7em;\">${field.label}</label>\n    <input\n      type=\"number\"\n      .value=${getValue(node, field.path, field.default ?? 0)}\n      min=${field.min}\n      max=${field.max}\n      step=${field.step}\n      @input=${(e: Event) => onchange({ [field.path]: parseFloat((e.target as HTMLInputElement).value) })}\n      style=\"background: var(--input-bg); border: 1px solid var(--border-color); color: var(--text-color); border-radius: 4px; padding: 2px 4px; width: 60px; font-size: 0.8em;\"\n    />\n  </div>\n`;\n\nimport '../../views/scalar-slider';\n\nconst renderSliderField = (node: GridNode, field: Extract<InspectorFieldDef, { type: 'slider' }>, onchange: InspectorChangeHandler) => html`\n  <div class=\"field\" style=\"height: ${ROW_HEIGHT}px; display: flex; align-items: center; justify-content: space-between;\">\n    <label style=\"color: var(--text-muted); font-size: 0.7em;\">${field.label}</label>\n    <div style=\"flex: 1; margin-left: 8px; max-width: 120px;\">\n      <scalar-slider\n        .value=${getValue(node, field.path, field.default ?? field.min)}\n        .min=${field.min}\n        .max=${field.max}\n        .step=${field.step || 0.01}\n        @change=${(e: CustomEvent) => onchange({ [field.path]: e.detail })}\n        style=\"width: 100%;\"\n      ></scalar-slider>\n    </div>\n  </div>\n`;\n\nconst renderBooleanField = (node: GridNode, field: Extract<InspectorFieldDef, { type: 'boolean' }>, onchange: InspectorChangeHandler) => html`\n  <div class=\"field\" style=\"height: ${ROW_HEIGHT}px; display: flex; align-items: center; justify-content: space-between;\">\n    <label style=\"color: var(--text-muted); font-size: 0.7em;\">${field.label}</label>\n    <input\n      type=\"checkbox\"\n      .checked=${getValue(node, field.path, field.default ?? false)}\n      @change=${(e: Event) => onchange({ [field.path]: (e.target as HTMLInputElement).checked })}\n    />\n  </div>\n`;\n\nconst renderSelectField = (node: GridNode, field: Extract<InspectorFieldDef, { type: 'select' }>, onchange: InspectorChangeHandler) => html`\n  <div class=\"field\" style=\"height: ${ROW_HEIGHT}px; display: flex; align-items: center; justify-content: space-between;\">\n    <label style=\"color: var(--text-muted); font-size: 0.7em;\">${field.label}</label>\n    <select\n      .value=${getValue(node, field.path, field.default ?? field.options[0]?.value)}\n      @change=${(e: Event) => onchange({ [field.path]: (e.target as HTMLSelectElement).value })}\n      style=\"background: var(--input-bg); border: 1px solid var(--border-color); color: var(--text-color); border-radius: 4px; padding: 2px 4px; font-size: 0.8em;\"\n    >\n      ${field.options.map(opt => html`<option value=${opt.value}>${opt.label}</option>`)}\n    </select>\n  </div>\n`;\n\nconst renderStructorTypeField = (node: GridNode, field: Extract<InspectorFieldDef, { type: 'structor-type' }>, onchange: InspectorChangeHandler) => html`\n  <div class=\"field\" style=\"height: ${ROW_HEIGHT}px; display: flex; align-items: center; justify-content: space-between;\">\n    <label style=\"color: var(--text-muted); font-size: 0.7em;\">${field.label}</label>\n    <div style=\"flex: 1; margin-left: 8px;\">\n      <ui-option-bar\n        .value=${getValue(node, field.path, field.default ?? 'float')}\n        .options=${[\n    { label: 'float', value: 'float' },\n    { label: 'float2', value: 'float2' },\n    { label: 'float3', value: 'float3' },\n    { label: 'float4', value: 'float4' },\n    { label: 'midi', value: 'midi-stream' },\n    { label: 'string', value: 'string' },\n    { label: 'any', value: 'any' }\n  ]}\n        @change=${(e: CustomEvent) => onchange({ [field.path]: e.detail.value })}\n      ></ui-option-bar>\n    </div>\n  </div>\n`;\n\nconst renderTabBarField = (node: GridNode, field: Extract<InspectorFieldDef, { type: 'tab-bar' }>, onchange: InspectorChangeHandler) => html`\n  <div class=\"field\" style=\"height: ${ROW_HEIGHT}px; display: flex; align-items: center; justify-content: space-between;\">\n    <label style=\"color: var(--text-muted); font-size: 0.7em;\">${field.label}</label>\n    <div style=\"flex: 1; margin-left: 8px;\">\n      <ui-option-bar\n        .value=${getValue(node, field.path, field.default ?? field.options[0]?.value)}\n        .options=${field.options}\n        @change=${(e: CustomEvent) => onchange({ [field.path]: e.detail.value })}\n      ></ui-option-bar>\n    </div>\n  </div>\n`;\n\nconst renderButtonField = (node: GridNode, field: Extract<InspectorFieldDef, { type: 'button' }>, onchange: InspectorChangeHandler) => html`\n  <div class=\"field\" style=\"height: ${ROW_HEIGHT}px; display: flex; align-items: center; justify-content: space-between;\">\n    <label style=\"color: var(--text-muted); font-size: 0.7em;\">${field.label}</label>\n    <button\n      @pointerdown=${() => onchange({ [field.path]: 1 })}\n      @pointerup=${() => onchange({ [field.path]: 0 })}\n      @pointerleave=${() => onchange({ [field.path]: 0 })}\n      style=\"background: var(--button-bg, #444); color: var(--text-color); border: 1px solid var(--border-color); border-radius: 4px; padding: 4px 8px; cursor: pointer; font-size: 0.8em; min-width: 60px;\"\n    >${field.text || 'Trigger'}</button>\n  </div>\n`;\n\nexport const createGenericInspector = (fields: InspectorFieldDef[]) => {\n  return (node: GridNode, onchange: InspectorChangeHandler): TemplateResult => {\n    return html`\n      <div class=\"generic-inspector\" style=\"display: flex; flex-direction: column;\">\n        ${fields.map(field => {\n      switch (field.type) {\n        case 'string': return renderStringField(node, field, onchange);\n        case 'number': return renderNumberField(node, field, onchange);\n        case 'slider': return renderSliderField(node, field, onchange);\n        case 'boolean': return renderBooleanField(node, field, onchange);\n        case 'select': return renderSelectField(node, field, onchange);\n        case 'tab-bar': return renderTabBarField(node, field, onchange);\n        case 'structor-type': return renderStructorTypeField(node, field, onchange);\n        case 'button': return renderButtonField(node, field, onchange);\n        default: return html``;\n      }\n    })}\n      </div>\n    `;\n  };\n};\n"],"names":["getValue","node","path","fallback","val","nodeType","defaultNodeRepository","input","i","renderStringField","field","onchange","html","ROW_HEIGHT","e","renderNumberField","renderSliderField","renderBooleanField","renderSelectField","opt","renderStructorTypeField","renderTabBarField","renderButtonField","createGenericInspector","fields"],"mappings":"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"}